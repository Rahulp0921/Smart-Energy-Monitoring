<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Energy Monitoring Dashboard</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root{--bg:#ffffff;--surface:#ffffff;--muted:#475569;--border:#e6edf3;--text:#0f172a}
    .dark{--bg:#0b1220;--surface:#0f172a;--muted:#94a3b8;--border:#1f2937;--text:#e6eef8}
    html,body{height:100%}
    body{
      background:var(--bg);
      color:var(--text);
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      transition:background-color .25s ease, color .25s ease;
      margin:0;
      padding:0;
    }

    /* Smooth card background transition */
    .surface{background:var(--surface);transition:background .25s ease,border-color .25s ease}
  </style>
</head>
<body class="antialiased">

  <div id="root" class="p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto">
    <header class="mb-6 flex items-center justify-between">
      <div>
        <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight">Smart Energy Monitoring Dashboard</h1>
        <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Predicting demand and optimizing consumption for a sustainable future.</p>
      </div>

      <!-- Theme toggle (iOS style) -->
      <div class="flex items-center space-x-3">
        <span class="text-xs text-slate-600 dark:text-slate-400">Theme</span>
        <label class="relative inline-flex items-center cursor-pointer">
          <input id="themeToggle" type="checkbox" class="sr-only" />
          <div class="w-12 h-6 bg-slate-300 dark:bg-slate-700 rounded-full peer transition-all"></div>
          <div id="toggleKnob" class="absolute left-0.5 top-0.5 w-5 h-5 bg-white dark:bg-slate-800 rounded-full shadow transform transition-transform"></div>
        </label>
      </div>
    </header>

    <!-- KPI Cards -->
    <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
      <div class="surface border rounded-lg p-4 flex items-center shadow-sm border-slate-200 dark:border-slate-700">
        <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-full mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
        </div>
        <div>
          <div class="text-sm text-slate-600 dark:text-slate-400">Current Consumption</div>
          <div class="text-2xl font-bold"><span id="kpi-current">...</span> <span class="text-sm font-medium text-slate-500 dark:text-slate-300">kW</span></div>
        </div>
      </div>

      <div class="surface border rounded-lg p-4 flex items-center shadow-sm border-slate-200 dark:border-slate-700">
        <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-full mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>
        </div>
        <div>
          <div class="text-sm text-slate-600 dark:text-slate-400">24h Avg Consumption</div>
          <div class="text-2xl font-bold"><span id="kpi-avg">...</span> <span class="text-sm font-medium text-slate-500 dark:text-slate-300">kW</span></div>
        </div>
      </div>

      <div class="surface border rounded-lg p-4 flex items-center shadow-sm border-slate-200 dark:border-slate-700">
        <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-full mr-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 11l7-7 7 7M5 19l7-7 7 7" /></svg>
        </div>
        <div>
          <div class="text-sm text-slate-600 dark:text-slate-400">24h Peak Consumption</div>
          <div class="text-2xl font-bold"><span id="kpi-peak">...</span> <span class="text-sm font-medium text-slate-500 dark:text-slate-300">kW</span></div>
        </div>
      </div>
    </section>

    <!-- Charts -->
    <main class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <section class="surface border rounded-lg p-6 shadow-lg border-slate-200 dark:border-slate-700">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-medium">Consumption Forecast</h2>
          <div class="flex items-center space-x-2 bg-slate-100 dark:bg-slate-700 p-1 rounded-md">
            <button id="btn-Zone1" class="px-3 py-1 rounded-md bg-cyan-600 text-white">Zone 1</button>
            <button id="btn-Zone2" class="px-3 py-1 rounded-md text-slate-700 dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600">Zone 2</button>
            <button id="btn-Zone3" class="px-3 py-1 rounded-md text-slate-700 dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600">Zone 3</button>
          </div>
        </div>
        <div style="height:420px;">
          <canvas id="energyChart"></canvas>
        </div>
      </section>

      <section class="space-y-6">
        <div class="surface border rounded-lg p-6 shadow-lg border-slate-200 dark:border-slate-700">
          <h3 class="font-medium mb-3">Total Consumption by Zone</h3>
          <div style="height:260px;"><canvas id="zonePieChart"></canvas></div>
        </div>

        <div class="surface border rounded-lg p-6 shadow-lg border-slate-200 dark:border-slate-700">
          <h3 class="font-medium mb-3">Avg. Consumption by Hour</h3>
          <div style="height:260px;"><canvas id="hourlyBarChart"></canvas></div>
        </div>
      </section>
    </main>

    <!-- Manual Data -->
    <section class="surface border rounded-lg p-6 shadow-lg border-slate-200 dark:border-slate-700 mt-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-medium">Add Manual Data Point & Predict</h2>
        <p class="text-xs text-slate-500 dark:text-slate-400">Note: Data is session-only and will reset on reload.</p>
      </div>

      <form id="manualDataForm" class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
        <div>
          <label for="manualDate" class="block text-sm text-slate-700 dark:text-slate-300">Date & Time</label>
          <input id="manualDate" type="datetime-local" required class="mt-1 block w-full bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-md py-2 px-3 text-slate-900 dark:text-slate-100" />
        </div>
        <div>
          <label for="manualConsumption" class="block text-sm text-slate-700 dark:text-slate-300">Consumption (kW)</label>
          <input id="manualConsumption" type="number" required class="mt-1 block w-full bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-md py-2 px-3 text-slate-900 dark:text-slate-100" placeholder="e.g., 47000" />
        </div>
        <div>
          <label for="manualTemp" class="block text-sm text-slate-700 dark:text-slate-300">Temperature (Â°C)</label>
          <input id="manualTemp" type="number" step="0.1" required class="mt-1 block w-full bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-md py-2 px-3 text-slate-900 dark:text-slate-100" placeholder="e.g., -5" />
        </div>
        <div class="md:col-span-2 grid grid-cols-1 gap-2">
          <button id="addBtn" type="submit" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white py-2 px-4 rounded-md">Add & Predict</button>
          <button id="resetDataBtn" type="button" class="w-full bg-slate-200 dark:bg-slate-600 text-slate-900 dark:text-slate-100 py-2 px-4 rounded-md">Reset Data</button>
        </div>
      </form>

      <div class="mt-4 flex items-center">
        <input id="forceAlert" type="checkbox" class="h-4 w-4 rounded border-slate-400 dark:border-slate-500 bg-white dark:bg-slate-700 text-cyan-600" />
        <label for="forceAlert" class="ml-2 text-sm text-slate-700 dark:text-slate-300">Force Show Alert (for testing)</label>
      </div>
    </section>

    <div id="alert-container" class="mt-6"></div>

    <footer class="text-center text-slate-500 dark:text-slate-400 mt-8 text-sm">
      <p>Smart Energy Monitoring System | A Full-Stack Demonstration</p>
    </footer>
  </div>

  <script>
    // --- DATA ---
    const initialEnergyData = Object.freeze([
      {"DateTime":"2017-01-15 00:00","Temperature":7.8,"Zone1":32050,"Zone2":18030,"Zone3":19520},
      {"DateTime":"2017-01-15 01:00","Temperature":7.6,"Zone1":31080,"Zone2":17540,"Zone3":18910},
      {"DateTime":"2017-01-15 02:00","Temperature":7.5,"Zone1":30120,"Zone2":17110,"Zone3":18450},
      {"DateTime":"2017-01-15 03:00","Temperature":7.3,"Zone1":29540,"Zone2":16820,"Zone3":18110},
      {"DateTime":"2017-01-15 04:00","Temperature":7.2,"Zone1":29880,"Zone2":16950,"Zone3":18240},
      {"DateTime":"2017-01-15 05:00","Temperature":7.1,"Zone1":30950,"Zone2":17450,"Zone3":18760},
      {"DateTime":"2017-01-15 06:00","Temperature":7.0,"Zone1":33500,"Zone2":18890,"Zone3":20310},
      {"DateTime":"2017-01-15 07:00","Temperature":7.0,"Zone1":36800,"Zone2":20750,"Zone3":22310},
      {"DateTime":"2017-01-15 08:00","Temperature":7.2,"Zone1":38900,"Zone2":21950,"Zone3":23600},
      {"DateTime":"2017-01-15 09:00","Temperature":7.8,"Zone1":40150,"Zone2":22650,"Zone3":24350},
      {"DateTime":"2017-01-15 10:00","Temperature":8.5,"Zone1":40800,"Zone2":23000,"Zone3":24730},
      {"DateTime":"2017-01-15 11:00","Temperature":9.2,"Zone1":41100,"Zone2":23180,"Zone3":24920},
      {"DateTime":"2017-01-15 12:00","Temperature":9.8,"Zone1":40500,"Zone2":22850,"Zone3":24570},
      {"DateTime":"2017-01-15 13:00","Temperature":10.1,"Zone1":39800,"Zone2":22450,"Zone3":24140},
      {"DateTime":"2017-01-15 14:00","Temperature":10.2,"Zone1":38900,"Zone2":21950,"Zone3":23600},
      {"DateTime":"2017-01-15 15:00","Temperature":9.9,"Zone1":38200,"Zone2":21550,"Zone3":23170},
      {"DateTime":"2017-01-15 16:00","Temperature":9.5,"Zone1":39500,"Zone2":22280,"Zone3":23950},
      {"DateTime":"2017-01-15 17:00","Temperature":9.1,"Zone1":42300,"Zone2":23850,"Zone3":25640},
      {"DateTime":"2017-01-15 18:00","Temperature":8.8,"Zone1":44500,"Zone2":25100,"Zone3":26980},
      {"DateTime":"2017-01-15 19:00","Temperature":8.6,"Zone1":43800,"Zone2":24700,"Zone3":26550},
      {"DateTime":"2017-01-15 20:00","Temperature":8.4,"Zone1":42100,"Zone2":23750,"Zone3":25530},
      {"DateTime":"2017-01-15 21:00","Temperature":8.2,"Zone1":40200,"Zone2":22680,"Zone3":24380},
      {"DateTime":"2017-01-15 22:00","Temperature":8.1,"Zone1":38100,"Zone2":21490,"Zone3":23000},
      {"DateTime":"2017-01-15 23:00","Temperature":8.0,"Zone1":35500,"Zone2":20020,"Zone3":21520}
    ]);

    let energyData = [...initialEnergyData];
    let currentZone = 'Zone1';
    let myChart = null, zonePieChart = null, hourlyBarChart = null;

    // --- Forecast model ---
    function generateForecast(data, zoneKey, hours){
      const out = [];
      if(data.length < 7) return out;
      const last = data[data.length-1];
      const lastVal = last[zoneKey];
      const lastTemp = last.Temperature;

      const avg = data.slice(-6).reduce((s,i)=>s+i[zoneKey],0)/6;
      const trend = (avg - data[data.length-7][zoneKey])/6;
      const TEMP_SENS = 0.02, BASE_TEMP = 15;

      for(let i=1;i<=hours;i++){
        const nextDate = new Date(new Date(last.DateTime).getTime() + i*3600000);
        const hour = nextDate.getHours();
        let val = lastVal + trend*i;
        const seasonal = Math.sin((hour-6)*Math.PI/12)*0.05 + 0.98;
        val *= seasonal;
        const tempDiff = Math.abs(lastTemp - BASE_TEMP);
        val *= (1 + tempDiff*TEMP_SENS);
        out.push({DateTime: nextDate.toISOString().slice(0,16).replace('T',' '), Forecast: Math.max(0,val)});
      }
      return out;
    }

    function formatTime(str){
      const d = new Date(str);
      return d.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
    }

    function updateKPIs(zone,data){
      const current = data[data.length-1][zone];
      const avg = data.reduce((s,i)=>s+i[zone],0)/data.length;
      const peak = Math.max(...data.map(i=>i[zone]));
      document.getElementById('kpi-current').textContent = (current/1000).toFixed(1);
      document.getElementById('kpi-avg').textContent = (avg/1000).toFixed(1);
      document.getElementById('kpi-peak').textContent = (peak/1000).toFixed(1);
      return {peak};
    }

    function updateAlert(forecast, peak){
      const container = document.getElementById('alert-container');
      const force = document.getElementById('forceAlert').checked;
      if(!forecast.length && !force){ container.innerHTML=''; return; }
      const peakF = forecast.reduce((m,i)=> i.Forecast>m.Forecast?i:m, {Forecast:0,DateTime:new Date().toISOString()});
      if(force || peakF.Forecast > peak*1.05){
        container.innerHTML = `
          <div class="bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700 p-4 rounded-md">
            <div class="flex items-start gap-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"/></svg>
              <div>
                <div class="font-semibold text-yellow-800 dark:text-yellow-200">Optimization Alert: High Demand Forecasted</div>
                <div class="text-sm text-yellow-700 dark:text-yellow-100 mt-1">A peak consumption of approximately <strong>${(peakF.Forecast/1000).toFixed(1)}k kW</strong> is predicted around <strong>${formatTime(peakF.DateTime)}</strong>.</div>
              </div>
            </div>
          </div>`;
      } else { container.innerHTML=''; }
    }

    // --- Chart helpers ---
    function isDark(){ return document.documentElement.classList.contains('dark'); }

    function chartColors(){
      if(isDark()){
        return {
          axis: '#94a3b8',
          grid: '#1f2937',
          tooltipBg: '#0f172a',
          tooltipBorder: '#334155',
          dataset1: '#22d3ee',
          dataset2: '#fb7185',
          pieBorders: '#0b1220'
        }
      }
      return {
        axis: '#475569',
        grid: '#e6edf3',
        tooltipBg: '#ffffff',
        tooltipBorder: '#cbd5e1',
        dataset1: '#0ea5a4',
        dataset2: '#ef4444',
        pieBorders: '#ffffff'
      }
    }

    function renderMainChart(zone,data,forecast){
      const cols = chartColors();
      const labels = data.map(d=>formatTime(d.DateTime)).concat(forecast.map(f=>formatTime(f.DateTime)));
      const actual = data.map(d=>d[zone]).concat(new Array(forecast.length).fill(null));
      const forecastSeries = new Array(data.length).fill(null).concat(forecast.map(f=>f.Forecast));

      const cfg = {
        type:'line',
        data:{labels, datasets:[
          {label:'Actual Consumption', data:actual, borderColor:cols.dataset1, backgroundColor:cols.dataset1+'22', fill:true, tension:0.3, borderWidth:2, pointRadius:0},
          {label:'Forecasted Demand', data:forecastSeries, borderColor:cols.dataset2, backgroundColor:cols.dataset2+'22', fill:true, tension:0.3, borderWidth:2, borderDash:[6,4], pointRadius:0}
        ]},
        options:{
          responsive:true, maintainAspectRatio:false,
          interaction:{mode:'index', intersect:false},
          plugins:{
            legend:{ labels:{ color: cols.axis } },
            tooltip:{
              backgroundColor: cols.tooltipBg, borderColor: cols.tooltipBorder, borderWidth:1, titleColor:cols.axis, bodyColor:cols.axis,
              callbacks:{ label: ctx => {
                if(ctx.parsed.y===null) return null; return (ctx.dataset.label?ctx.dataset.label+': ':'') + (ctx.parsed.y/1000).toFixed(1) + 'k kW';
              }}
            }
          },
          scales:{ x:{ ticks:{ color:cols.axis }, grid:{ color:cols.grid } }, y:{ ticks:{ color:cols.axis, callback: v=> (v/1000).toFixed(0)+'k' }, grid:{ color:cols.grid }} }
        }
      };

      if(myChart) myChart.destroy();
      myChart = new Chart(document.getElementById('energyChart').getContext('2d'), cfg);
    }

    function renderZonePie(data){
      const cols = chartColors();
      const totals = { 'Zone 1': data.reduce((s,i)=>s+i.Zone1,0), 'Zone 2': data.reduce((s,i)=>s+i.Zone2,0), 'Zone 3': data.reduce((s,i)=>s+i.Zone3,0) };
      const cfg = {
        type:'pie', data:{ labels: Object.keys(totals), datasets:[{ data:Object.values(totals), backgroundColor:['#22d3ee','#fb7185','#4ade80'], borderColor: cols.pieBorders, borderWidth:2 }]},
        options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{ labels:{ color: cols.axis } } } }
      };
      if(zonePieChart) zonePieChart.destroy();
      zonePieChart = new Chart(document.getElementById('zonePieChart').getContext('2d'), cfg);
    }

    function renderHourlyBar(zone,data){
      const cols = chartColors();
      const hourly = Array.from({length:24}, ()=>({sum:0,count:0}));
      data.forEach(it=>{ const h = new Date(it.DateTime).getHours(); hourly[h].sum += it[zone]; hourly[h].count++; });
      const avg = hourly.map(h=> h.count? h.sum/h.count : 0);
      const total = avg.reduce((s,v)=>s+v,0);

      const cfg = {
        type:'bar', data:{ labels: Array.from({length:24},(_,i)=>i+':00'), datasets:[{ label:`Avg Consumption for ${zone}`, data:avg, backgroundColor:'rgba(34,211,238,0.6)', borderColor:'#22d3ee', borderWidth:1 }]},
        options:{
          responsive:true, maintainAspectRatio:false,
          plugins:{ legend:{ display:false }, tooltip:{ backgroundColor:cols.tooltipBg, borderColor:cols.tooltipBorder, borderWidth:1, titleColor:cols.axis, bodyColor:cols.axis, callbacks:{ label: ctx=>{ const v=ctx.parsed.y; if(v===null) return null; const pct = total>0? ((v/total)*100).toFixed(1)+'%':'0.0%'; return `Consumption: ${(v/1000).toFixed(1)}k kW (${pct})`; }}}},
          scales:{ x:{ ticks:{ color:cols.axis }, grid:{ color:cols.grid } }, y:{ ticks:{ color:cols.axis, callback:v=> (v/1000).toFixed(0)+'k' }, grid:{ color:cols.grid } } }
        }
      };

      if(hourlyBarChart) hourlyBarChart.destroy();
      hourlyBarChart = new Chart(document.getElementById('hourlyBarChart').getContext('2d'), cfg);
    }

    function updateAll(zone, data, histPeak=null){
      const forecast = generateForecast(data, zone, 24);
      const kpis = updateKPIs(zone, data);
      const peakForAlert = histPeak!==null? histPeak : kpis.peak;
      updateAlert(forecast, peakForAlert);
      renderMainChart(zone,data,forecast);
      renderZonePie(data);
      renderHourlyBar(zone,data);
    }

    // --- Event handlers ---
    function switchZone(zone){
      currentZone = zone;
      ['Zone1','Zone2','Zone3'].forEach(z=>{ const b = document.getElementById('btn-'+z); b.className = (z===zone)? 'px-3 py-1 rounded-md bg-cyan-600 text-white' : 'px-3 py-1 rounded-md text-slate-700 dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600'; });
      updateAll(zone, energyData);
    }

    function addManualData(e){
      e.preventDefault();
      const date = document.getElementById('manualDate').value;
      const cons = parseFloat(document.getElementById('manualConsumption').value);
      const temp = parseFloat(document.getElementById('manualTemp').value);
      if(!date || isNaN(cons) || isNaN(temp)) return;
      const histPeak = Math.max(...energyData.map(i=>i[currentZone]));
      const last = energyData.length? energyData[energyData.length-1] : {};
      const newP = { DateTime: date.replace('T',' '), Temperature: temp, Zone1: last.Zone1||cons, Zone2: last.Zone2||cons, Zone3: last.Zone3||cons };
      newP[currentZone] = cons;
      energyData.push(newP);
      energyData.sort((a,b)=> new Date(a.DateTime)- new Date(b.DateTime));
      updateAll(currentZone, energyData, histPeak);
      document.getElementById('manualDataForm').reset();
      const next = new Date(energyData[energyData.length-1].DateTime); next.setHours(next.getHours()+1);
      document.getElementById('manualDate').value = next.toISOString().slice(0,16);
    }

    function resetData(){ energyData = [...initialEnergyData]; updateAll(currentZone, energyData); }

    // --- Theme handling ---
    const themeToggle = document.getElementById('themeToggle');
    function applyTheme(mode){
      if(mode==='dark'){ document.documentElement.classList.add('dark'); themeToggle.checked=true; document.getElementById('toggleKnob').style.transform='translateX(1.5rem)'; }
      else { document.documentElement.classList.remove('dark'); themeToggle.checked=false; document.getElementById('toggleKnob').style.transform='translateX(0)'; }
      // re-render charts with new palette
      updateAll(currentZone, energyData);
    }

    themeToggle.addEventListener('change', ()=>{ applyTheme(themeToggle.checked? 'dark':'light'); localStorage.setItem('theme', themeToggle.checked? 'dark':'light'); });
    // load saved theme or system preference
    const saved = localStorage.getItem('theme');
    if(saved) applyTheme(saved);
    else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) applyTheme('dark');
    else applyTheme('light');

    // --- Init ---
    document.getElementById('manualDataForm').addEventListener('submit', addManualData);
    document.getElementById('resetDataBtn').addEventListener('click', resetData);
    document.getElementById('btn-Zone1').addEventListener('click', ()=>switchZone('Zone1'));
    document.getElementById('btn-Zone2').addEventListener('click', ()=>switchZone('Zone2'));
    document.getElementById('btn-Zone3').addEventListener('click', ()=>switchZone('Zone3'));
    document.getElementById('forceAlert').addEventListener('change', ()=>updateAll(currentZone, energyData));

    window.addEventListener('load', ()=>{
      // set default datetime
      const last = new Date(energyData[energyData.length-1].DateTime); last.setHours(last.getHours()+1);
      document.getElementById('manualDate').value = last.toISOString().slice(0,16);
      updateAll(currentZone, energyData);
    });
  </script>
</body>
</html>
